(function(){function a(e,i,h,c,j){var d=new zkex.inp.Color();d.setRGB(i,h,c);var f=d.getHex();e.push('<div class="',j,'-colorbox" style="background-color: ',f,';cursor:pointer;"><span style="display:none;">',f,"</span></div>")}var b=zkex.inp.PalettePop=zk.$extends(zk.Widget,{$init:function(c){this.$supers("$init",arguments);this._wgt=c._wgt;this._color=new zkex.inp.Color()},redraw:function(e){var h=this.getZclass(),g=this.uuid,f,d,c;e.push('<div id="',g,'" class="',h,'">','<div id="',g,'-newcolor" class="',h,'-newcolor"></div>','<input id="',g,'-hex-inp" class="',h,'-hex-inp" type="text" size="7" maxlength="7"></input>');for(d=0;d<12;d++){for(c=0;c<3;c++){for(f=0;f<=5;f++){e.push(a(e,c*51+(d%2)*51*3,Math.floor(d/2)*51,f*51,h))}}}for(f=0;f<16;f++){d=Math.floor((f+f*16)%256);e.push(a(e,d,d,d,h))}e.push(a(e,255,255,255,h),a(e,255,255,255,h),"</div>")},getZclass:function(){return"z-colorpalette"},onFloatUp:function(c){if(!zUtl.isAncestor(this.parent,c.origin)){this._wgt.onHide()}},bind_:function(){this.$supers(b,"bind_",arguments);this.domListen_(this.$n("btn"),"onClick","_doPopupPicker");zWatch.listen({onShow:this,onFloatUp:this,onHide:this})},unbind_:function(){this.domUnlisten_(this.$n("btn"),"onClick","_doPopupPicker");zWatch.unlisten({onShow:this,onFloatUp:this,onHide:this});this.$supers(b,"unbind_",arguments)},onShow:function(){this.$n("newcolor").style.backgroundColor=this._color.getHex()},onHide:function(){this._wgt.onHide()},setColor:function(c){this._color.setHex(c)},_doPopupPicker:function(c){var d=this._wgt;d.closePalette();d.openPicker();c.stop()},doMouseOver_:function(c){var f=c.domTarget,g=this.getZclass();if(jq(f).hasClass(g+"-colorbox")){jq(f).addClass(g+"-colorbox-over");var d=f.firstChild,e=d.textContent||d.innerText;this.$n("newcolor").style.backgroundColor=e;this.$n("hex-inp").value=e;c.stop()}this.$supers("doMouseOver_",arguments)},doMouseOut_:function(c){jq(c.domTarget).removeClass(this.getZclass()+"-colorbox-over")},doClick_:function(c){var e=c.domTarget,f=this.getZclass();if(jq(e).hasClass(f+"-colorbox")){if(!this.$n("hex-inp").value){var d=e.firstChild;this.$n("hex-inp").value=d.textContent||d.innerText}this._wgt.onChange(this.$n("hex-inp").value);this._wgt.closePalette(true);jq(e).removeClass(f+"-colorbox-over");c.stop()}this.$supers("doClick_",arguments)},_doHexChange:function(){var e=this._wgt,c=this._color;c.setHex(this.$n("hex-inp").value);var d=c.getHex();this.$n("hex-inp").value=d;e.onChange(d);e.closePalette(true)},doKeyDown_:function(c){var f=c.keyCode,e=c.domTarget,d=this.$n("hex-inp");switch(f){case 48:case 96:case 49:case 97:case 50:case 98:case 51:case 99:case 52:case 100:case 53:case 101:case 54:case 102:case 55:case 103:case 56:case 104:case 57:case 105:case 37:case 39:case 46:case 8:break;case 13:if(e==d){this._doHexChange();return}default:if(e==d&&"ABCDEF".indexOf(String.fromCharCode(f))>0){break}c.stop();return}}})})();