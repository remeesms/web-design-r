zkex.sel.Listgroup=zk.$extends(zul.sel.Listitem,{_open:true,$define:{open:function(a){this._openItem(a,true);if(a){this.getListbox().stripe()}}},getItems:function(){var b=[];for(var a=this.nextSibling;a&&!a.$instanceof(zkex.sel.Listgroup);a=a.nextSibling){b.push(a)}return b},getItemCount:function(){return this.getItems().length},getZclass:function(){return this._zclass!=null?this._zclass:"z-listgroup"},getLabel:function(){return this.firstChild!=null?this.firstChild.getLabel():null},domContent_:function(){var b=this.getLabel(),a=this.domImage_();return b?a+" ":a},isStripeable_:function(){return false},_toggleEffect:function(a){if(!this.getListbox().groupSelect){return}this.$supers("_toggleEffect",arguments)},doSelect_:function(a){if(!this.getListbox().groupSelect){return}this.$supers("doSelect_",arguments)},_doImgClick:function(b){var c=!this.isOpen(),a=this.getListbox();if(!c){zWatch.fireDown("onHide",this.parent)}this._openItem(c);if(c||a.getModel()){if(c){this.parent.stripe()}if(!a.paging){a.onSize()}}if(c){zUtl.fireShown(this.parent)}b.stop()},_openItem:function(f,e){this._open=f;var d=this.$n("img"),g=this.getZclass();if(d){jq(d)[f?"removeClass":"addClass"](g+"-img-close")[f?"addClass":"removeClass"](g+"-img-open")}var c=this.getListbox(),b=c?c.inPagingMold():false,a=c?c.isModel():false;if(!b){this._openItemNow(f)}if(!e){this.fire("onOpen",{open:f},{toServer:b||a||c._listbox$rod})}},_openItemNow:function(b){var a=this.$n();if(a){for(var c,a=a.nextSibling;a&&(c=zk.Widget.$(a))&&!zkex.sel.Listgroup.isInstance(c)&&!zkex.sel.Listgroupfoot.isInstance(c);a=a.nextSibling){if(c.desktop&&c.isVisible()){jq(a)[b?"show":"hide"]()}}}},beforeParentChanged_:function(e){if(e==null){var d=this.getListbox(),b=d.hasGroup();if(b){for(var a=d.getGroups(),f=d.getGroupCount();--f>=0;){if(a[f]==this){b=a[--f];break}}}if(b){this._unbindafter=[function(){if(b){b._openItem(b.isOpen(),true)}}]}else{this._openItemNow(true,true)}}this.$supers("beforeParentChanged_",arguments)},onChildAdded_:function(a){this.$supers("onChildAdded_",arguments);this.rerender()},onChildRemoved_:function(a){this.$supers("onChildRemoved_",arguments);if(!this.childReplacing_){this.rerender()}},bind_:function(){this.$supers(zkex.sel.Listgroup,"bind_",arguments);var g=this.$n(),a,e=g.parentNode.parentNode;if(a=this.$n("img")){this.domListen_(a,"onClick","_doImgClick")}if(e.tBodies.length>1){var d=0;for(var f=e.rows[0],c=f.cells.length;c--;){if(zk(f.cells[c]).isVisible()){d++}}for(var b=g.cells,c=b.length;c--;){d-=b[c].colSpan}if(d>0&&g.cells.length){g.cells[g.cells.length-1].colSpan+=d}}},unbind_:function(c,b){var a;if(a=this.$n("img")){this.domUnlisten_(a,"onClick","_doImgClick")}if(this._unbindafter&&this._unbindafter.length){b.push(this._unbindafter.pop())}this._unbindafter=null;this.$supers(zkex.sel.Listgroup,"unbind_",arguments)}});